<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Land use statistics map</title>

    <!-- CSS libraries -->
    <link href="http://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.min.css" rel="stylesheet" type="text/css">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="http://cdn.rawgit.com/Eonasdan/bootstrap-datetimepicker/a549aa8780dbda16f6cff545aeabc3d71073911e/build/css/bootstrap-datetimepicker.css" rel="stylesheet"/>

    <!-- Custom CSS styles -->
    <link href="{{url_for('static',filename='/styles/styles.css')}}" rel="stylesheet" type="text/css">
  </head>
  <body>
    <div class="container">
      <div class="col-sm-12">
      <div class="row"> <!-- TITLE ROW-->
        <div class="col-sm-12">
          <h1 class="text-center">Europe earthquakes 2000 - 2023 </h1>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-6"> <!-- 1 SCREEN HALF -->
          <div class="row"> <!-- FIRST ROW-->
            <div class="col-sm-4">
              <p class="text-center">FROM DATE</p>
              <div class="form-group">
                <div class='input-group date' id='timestart'>
                    <input type='text' class="form-control" />
                    <span class="input-group-addon">
                        <span class="glyphicon glyphicon-calendar"></span>
                    </span>
                </div>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group">
                <p class="text-center">TO DATE</p>
                <div class='input-group date' id='timeend'>
                    <input type='text' class="form-control" />
                    <span class="input-group-addon">
                        <span class="glyphicon glyphicon-calendar"></span>
                    </span>
                </div>
              </div>
            </div>
            <div class="col-sm-4">
              <p class="text-center">SIGNIFICANCE</p>
              <select class="form-control" id="significance">
                <option value="*" selected="selected">ALL</option>
                <option value="0-49">0-49</option>
                <option value="50-99">200 - 299</option>
                <option value="100-199">300 - 399</option>
                <option value="200-299">400 - 499</option>
                <option value="300-399">400 - 499</option>
                <option value=">400">> 400</option>
              </select>
            </div>
          </div>
          <div class="row"> <!-- SECOND ROW-->
            <div class="col-sm-4">
              <p class="text-center">MIN MAG</p>
              <select class="form-control" id="min-magnitudo">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5" selected="selected">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
              </select>
            </div>
            <div class="col-sm-4">
              <p class="text-center">MAX MAG</p>
              <select class="form-control" id="max-magnitudo">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9" selected="selected">9</option>
              </select>
            </div>
            <div class="col-sm-4">
              <p class="text-center">DEPTH</p>
              <select class="form-control" id="depth">
                <option value="*" selected="selected">ALL</option>
                <option value="0-10">0-10</option>
                <option value="10-20">10-20</option>
              </select>
            </div>
          </div>
          <div class="row" style="margin-top: 15px;"> <!-- FOURTH ROW-->
            <div class="col-sm-4">
            </div>
            <div class="col-sm-4">
              <div class="text-center">
                <button type="button" class="text-center btn btn-primary" onclick="load_map()">APPLY FILTERS</button>
              </div>
            </div>
            <div class="col-sm-4">
            </div>
          </div>
          <div class="row" style="margin-top: 15px;"> <!-- THIRD ROW-->
            <div class="col-sm-12">
              <p>** Perform 1 click to show details - 2 clicks to select for elaboration</p>
              <div id="map">
              </div>
            </div>
          </div>
          <div class="row"> <!-- FOURTH ROW-->
            <div class="col-sm-12">
              <div id="details">
                <h1 id="details_h1"></h1>
                <table id="map_table" class="table">
                </table>
              </div>
            </div>
          </div>
        </div>
        <div class="col-sm-6"> <!-- 2 HALF SCREEN -->
          <div class="row"> <!-- FIRST ROW-->
            <div class="col-sm-12">
              <div class="text-center">
                <p class="text-center">T-SNE ALGORHITM</p>
                <div style="border: 2px; border-style: dotted; border-color: #327ab7;">
                  <h3 id="TSNE_text">SELECT 2 OR MORE COUNTRIES ON THE MAP</h3>
                </div>
                <div id="scatterplot"></div>
              </div>
            </div>
          </div>
          <div class="row" style="margin-top: 15px;"> <!-- SECOND ROW-->
            <div class="col-sm-12">
              <div class="text-center">
                <button type="button" class="text-center btn btn-primary" onclick="performTSNE()">ELABORATE</button>
              </div>
            </div>
        </div>
      </div>
    </div>

    <!-- JS libraries -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="http://cdn.rawgit.com/Eonasdan/bootstrap-datetimepicker/a549aa8780dbda16f6cff545aeabc3d71073911e/src/js/bootstrap-datetimepicker.js"></script>
    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.16/d3.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/mustache.js/2.2.1/mustache.min.js"></script>

    <!-- Custom JS code -->
    <script src="{{url_for('static',filename='/js/utils.js')}}"></script>
    <script src="{{url_for('static',filename='/js/map.js')}}"></script>
    <script src="{{url_for('static',filename='/js/scatterplot.js')}}"></script>
    <script type="text/javascript">
      function performTSNE() {
        console.log(selectedCountries)
        var country_data = {}
        for (const country of selectedCountries) {
          country_data[country] = dataById[country]
        }
        fetch("http://localhost:4242/tsne", {
          method: "POST",
          body: JSON.stringify({
            countries: country_data
          }),
          headers: {
            "Content-type": "application/json; charset=UTF-8"
          }
        })
        .then((response) => response.json())
        .then((json) => load_scatterplot(json));
      }
    </script>
    <script type="text/javascript">
      $(function() {              
         // Bootstrap DateTimePicker v4
         $('#timestart').datetimepicker({
              defaultDate: "1/1/2000",
              format: 'DD/MM/YYYY'
         });
      }); 
      $(function() {              
         // Bootstrap DateTimePicker v4
         $('#timeend').datetimepicker({
              defaultDate: "1/1/2023",
              format: 'DD/MM/YYYY'
         });
      });      

      
      window.onload = load_map;
  </script>
    
  </body>
</html>